<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <script src="https://unpkg.com/htmx.org@1.9.9"></script> 
</head>

<!--Hace que htmx pase el CSRF Token-->
<body hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <div class="container d-flex align-items-center justify-content-center">
                <div class="card d-flex align-items-center justify-content-center">
                    <div class="card-body">
                        <h2>Seleccione un dia</h2 >
                        <hr>
                        <div class="d-flex align-items-center justify-content-center">
                            <div id="calendario" hx-get='{% url "getDisponibilidad" id 'Miercoles'%}' hx-trigger="change" hx-target="#table-body"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <br>
    <br>
    <br>
    <br>
    <br>
    <br>
    <table class="table table-striped">
        <thead>
        <tr class="table table-dark">
            <th scope="col">Dia</th>
            <th scope="col">Hora inicio</th>
            <th scope="col">Hora termino</th>
            <th scope="col">Tiempo consulta</th>
            <th scope="col">estado</th>
            <th scope="col">Opciones</th>
        </tr>
        </thead>
        
        <tbody id="table-body">
            {% include "dispo_table_fragment.html" with data=data %}
        </tbody>
    </table>


    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    {% if messages %}
    {% for m in messages %}
        <script>
            
            Swal.fire({
            icon: 'success',
            text: '{{m}}'
            })
            
        </script>
    {% endfor %}
    {% endif %}
    <script>
    flatpickr("#calendario", {
        dateFormat: "Y-m-d",
        inline: true,
        minDate: "today",
        enable:{{fechas|safe}},
        locale: {
            firstDayOfWeek: 1
        },
        onChange: function(selectedDates, dateStr, instance){
            var fecha = selectedDates[0]
            console.log(fecha.getDay())
            var nose = String(fecha)
            var foo = nose.split(" ")
            console.log(foo[0])
        }
    });


    </script>
    
    
</body>
</html>